<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Likelihood Ratio and Wald-Type Tests for 'rma' Objects — anova.rma • metafor</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Likelihood Ratio and Wald-Type Tests for 'rma' Objects — anova.rma" />

<meta property="og:description" content="For two (nested) models of class &quot;rma.uni&quot; or &quot;rma.mv&quot;, the function provides a full versus reduced model comparison in terms of model fit statistics and a likelihood ratio test. When a single model is specified, a Wald-type test of one or more model coefficients or linear combinations thereof is carried out." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/index.php/jss/article/view/v036i03/v36i03.pdf">JSS Article (pdf)</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/wviechtb">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Likelihood Ratio and Wald-Type Tests for 'rma' Objects</h1>
    
    <div class="hidden name"><code>anova.rma.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>For two (nested) models of class <code>"rma.uni"</code> or <code>"rma.mv"</code>, the function provides a full versus reduced model comparison in terms of model fit statistics and a likelihood ratio test. When a single model is specified, a Wald-type test of one or more model coefficients or linear combinations thereof is carried out.</p>
    
    </div>

    <pre class="usage"># S3 method for rma
anova(object, object2, btt, L, digits, &#8230;)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an object of class <code>"rma.uni"</code> or <code>"rma.mv"</code>.</p></td>
    </tr>
    <tr>
      <th>object2</th>
      <td><p>an (optional) object of class <code>"rma.uni"</code> or <code>"rma.mv"</code>. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>btt</th>
      <td><p>optional vector of indices specifying which coefficients to include in the Wald-type test. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>optional numeric vector or matrix specifying linear combinations of the coefficients in the model that should be tested to be zero. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>integer specifying the number of decimal places to which the printed results should be rounded (if unspecified, the default is to take the value from the object).</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>other arguments.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When a single model is specified, the function provides Wald-type tests of one or more model coefficients or linear combinations thereof.</p>
<p>In particular, for a fixed- or random-effects model (i.e., a model without moderators), this is just the test of the single coefficient of the model. For models including moderators, an omnibus test of all the model coefficients is conducted that excludes the intercept (the first coefficient) if it is included in the model. If no intercept is included in the model, then the omnibus test includes all of the coefficients in the model including the first.</p>
<p>Alternatively, one can manually specify the indices of the coefficients to test via the <code>btt</code> argument. For example, with <code>btt=c(3,4)</code>, only the third and fourth coefficient from the model would be included in the test (if an intercept is included in the model, then it corresponds to the first coefficient in the model).</p>
<p>Instead, one can also specify one or multiple linear combinations of the coefficients in the model that should be tested to be zero via the <code>L</code> argument. If given as a matrix, its rows define the linear combinations to be tested. If the matrix is of full rank, an omnibus Wald-type test of all linear combinations is also provided.</p>
<p>When specifying two models for comparison, the function provides a likelihood ratio test comparing the two models. The two models must be based on the same set of data, must be of the same class, and should be nested for the likelihood ratio test to make sense. Note that likelihood ratio tests are not meaningful when using REML estimation and the two models have different fixed effects.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"anova.rma"</code>. When a single model is specified (without any further arguments or together with the <code>btt</code> argument), the object is a list containing the following components:</p>
<dt>QM</dt><dd><p>test statistic for the Wald-type test of model coefficients.</p></dd>
   <dt>QMp</dt><dd><p>p-value for the Wald-type test of model coefficients.</p></dd>
   <dt>btt</dt><dd><p>indices of the coefficients tested by the Wald-type test.</p></dd>
   <dt>k</dt><dd><p>number of outcomes included in the model fitting.</p></dd>
   <dt>p</dt><dd><p>number of coefficients in the model (including the intercept).</p></dd>
   <dt>m</dt><dd><p>number of coefficients included in the Wald-type test of coefficients.</p></dd>
   <dt>&#8230;</dt><dd><p>some additional elements/values.</p></dd>
   When argument L is specified, the object is a list containing the following components:
   <dt>QM</dt><dd><p>test statistic for the omnibus Wald-type test of all linear combinations.</p></dd>
   <dt>QMp</dt><dd><p>p-value for the omnibus Wald-type test.</p></dd>
   <dt>hyp</dt><dd><p>description of the linear combinations tested.</p></dd>
   <dt>Lb</dt><dd><p>values of the linear combinations.</p></dd>
   <dt>se</dt><dd><p>standard errors of the linear combinations.</p></dd>
   <dt>zval</dt><dd><p>test statistics of the linear combinations.</p></dd>
   <dt>pval</dt><dd><p>p-values for the linear combinations.</p></dd>
   When two models are specified, the object is a list containing the following components:
   <dt>fit.stats.f</dt><dd><p>log-likelihood, deviance, AIC, BIC, and AICc for the full model.</p></dd>
   <dt>fit.stats.r</dt><dd><p>log-likelihood, deviance, AIC, BIC, and AICc for the reduced model.</p></dd>
   <dt>p.f</dt><dd><p>number of parameters in the full model.</p></dd>
   <dt>p.r</dt><dd><p>number of parameters in the reduced model.</p></dd>
   <dt>LRT</dt><dd><p>likelihood ratio test statistic.</p></dd>
   <dt>pval</dt><dd><p>p-value for the likelihood ratio test.</p></dd>
   <dt>QE.f</dt><dd><p>test statistic for the test of (residual) heterogeneity from the full model.</p></dd>
   <dt>QE.r</dt><dd><p>test statistic for the test of (residual) heterogeneity from the reduced model.</p></dd>
   <dt>tau2.f</dt><dd><p>estimated \(\tau^2\) value from the full model. <code>NA</code> for <code>"rma.mv"</code> objects.</p></dd>
   <dt>tau2.r</dt><dd><p>estimated \(\tau^2\) value from the reduced model. <code>NA</code> for <code>"rma.mv"</code> objects.</p></dd>
   <dt>R2</dt><dd><p>amount (in percent) of the heterogeneity in the reduced model that is accounted for in the full model (<code>NA</code> for fixed-effects models or for <code>"rma.mv"</code> objects). This can be regarded as a pseudo \(R^2\) statistic (Raudenbush, 2009). Note that the value may not be very accurate unless \(k\) is large (Lopez-Lopez et al., 2014).</p></dd>
   <dt>&#8230;</dt><dd><p>some additional elements/values.</p></dd>

   The results are formatted and printed with the <a href='print.anova.rma.html'>print.anova.rma</a> function.

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>In principle, one can consider likelihood ratio tests for the amount of (residual) heterogeneity in random- and mixed-effects models. The full model should then be fitted with either <code>method="ML"</code> or <code>method="REML"</code> and the reduced model with <code>method="FE"</code>. The p-value from that test is based on a chi-square distribution with 1 degree of freedom, but actually needs to be adjusted for the fact that the parameter (i.e., \(\tau^2\)) falls on the boundary of the parameter space under the null hypothesis. Moreover, the Q-test usually keeps better control of the Type I error rate and therefore should be preferred (see Viechtbauer, 2007, for more details).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hardy, R. J., &amp; Thompson, S. G. (1996). A likelihood approach to meta-analysis with random effects. <em>Statistics in Medicine</em>, <b>15</b>, 619--629.</p>
<p>Huizenga, H. M., Visser, I., &amp; Dolan, C. V. (2011). Testing overall and moderator effects in random effects meta-regression. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>64</b>, 1--19.</p>
<p>López-López, J. A., Marín-Martínez, F., Sánchez-Meca, J., Van den Noortgate, W., &amp; Viechtbauer, W. (2014). Estimation of the predictive power of the model in mixed-effects meta-regression: A simulation study. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>67</b>, 30--48.</p>
<p>Raudenbush, S. W. (2009). Analyzing effect sizes: Random effects models. In H. Cooper, L. V. Hedges, &amp; J. C. Valentine (Eds.), <em>The handbook of research synthesis and meta-analysis</em> (2nd ed., pp. 295--315). New York: Russell Sage Foundation.</p>
<p>Viechtbauer, W. (2007). Hypothesis tests for population heterogeneity in meta-analysis. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>60</b>, 29--60.</p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1--48. <a href='http://www.jstatsoft.org/v36/i03/'>http://www.jstatsoft.org/v36/i03/</a>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rma.uni.html'>rma.uni</a></code>, <code><a href='print.anova.rma.html'>print.anova.rma</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### calculate log risk ratios and corresponding sampling variances</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span>(<span class='kw'>measure</span><span class='kw'>=</span><span class='st'>"RR"</span>, <span class='kw'>ai</span><span class='kw'>=</span><span class='no'>tpos</span>, <span class='kw'>bi</span><span class='kw'>=</span><span class='no'>tneg</span>, <span class='kw'>ci</span><span class='kw'>=</span><span class='no'>cpos</span>, <span class='kw'>di</span><span class='kw'>=</span><span class='no'>cneg</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat.bcg</span>)

<span class='co'>### random-effects model</span>
<span class='no'>res1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span>(<span class='no'>yi</span>, <span class='no'>vi</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"ML"</span>)

<span class='co'>### mixed-effects model with two moderators (absolute latitude and publication year)</span>
<span class='no'>res2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span>(<span class='no'>yi</span>, <span class='no'>vi</span>, <span class='kw'>mods</span> <span class='kw'>=</span> ~ <span class='no'>ablat</span> + <span class='no'>year</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"ML"</span>)

<span class='co'>### Wald-type test of the two moderators</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/anova'>anova</a></span>(<span class='no'>res2</span>)</div><div class='output co'>#&gt; 
#&gt; Test of Moderators (coefficients 2:3):
#&gt; QM(df = 2) = 33.9192, p-val &lt; .0001
#&gt; </div><div class='input'>
<span class='co'>### alternative way of specifying the same test</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/anova'>anova</a></span>(<span class='no'>res2</span>, <span class='kw'>L</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>rbind</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>)))</div><div class='output co'>#&gt; 
#&gt; Hypotheses:             
#&gt; 1: ablat = 0 
#&gt; 2:  year = 0 
#&gt; 
#&gt; Results:
#&gt;    estimate     se    zval   pval 
#&gt; 1:  -0.0308 0.0063 -4.9057 &lt;.0001 
#&gt; 2:  -0.0032 0.0092 -0.3471 0.7285 
#&gt; 
#&gt; Omnibus Test of Hypotheses:
#&gt; QM(df = 2) = 33.9192, p-val &lt; .0001
#&gt; </div><div class='input'>
<span class='co'>### corresponding likelihood ratio test</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/anova'>anova</a></span>(<span class='no'>res1</span>, <span class='no'>res2</span>)</div><div class='output co'>#&gt; 
#&gt;         df     AIC     BIC    AICc   logLik     LRT   pval       QE  tau^2 
#&gt; Full     4 23.2922 25.5520 28.2922  -7.6461                 28.3251 0.0269 
#&gt; Reduced  2 29.3302 30.4601 30.5302 -12.6651 10.0379 0.0066 152.2330 0.2800 
#&gt;              R^2 
#&gt; Full 
#&gt; Reduced 90.3948% 
#&gt; </div><div class='input'>
<span class='co'>### test of a linear combination</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/anova'>anova</a></span>(<span class='no'>res2</span>, <span class='kw'>L</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>35</span>,<span class='fl'>1970</span>))</div><div class='output co'>#&gt; 
#&gt; Hypothesis:                                      
#&gt; 1: intrcpt + 35*ablat + 1970*year = 0 
#&gt; 
#&gt; Results:
#&gt;    estimate     se    zval   pval 
#&gt; 1:  -0.7533 0.0837 -9.0039 &lt;.0001 
#&gt; 
#&gt; Test of Hypothesis:
#&gt; QM(df = 1) = 81.0700, p-val &lt; .0001
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Wolfgang Viechtbauer <a href='mailto:wvb@metafor-project.org'>wvb@metafor-project.org</a> <a href='http://www.metafor-project.org/'>http://www.metafor-project.org/</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

